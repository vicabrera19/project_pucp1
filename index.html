{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "687d5929-f14a-4a22-b8d8-a65ba2686423",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Country Name</th>\n",
       "      <th>Country Code</th>\n",
       "      <th>Series Name</th>\n",
       "      <th>Series Code</th>\n",
       "      <th>1960 [YR1960]</th>\n",
       "      <th>1961 [YR1961]</th>\n",
       "      <th>1962 [YR1962]</th>\n",
       "      <th>1963 [YR1963]</th>\n",
       "      <th>1964 [YR1964]</th>\n",
       "      <th>1965 [YR1965]</th>\n",
       "      <th>...</th>\n",
       "      <th>2013 [YR2013]</th>\n",
       "      <th>2014 [YR2014]</th>\n",
       "      <th>2015 [YR2015]</th>\n",
       "      <th>2016 [YR2016]</th>\n",
       "      <th>2017 [YR2017]</th>\n",
       "      <th>2018 [YR2018]</th>\n",
       "      <th>2019 [YR2019]</th>\n",
       "      <th>2020 [YR2020]</th>\n",
       "      <th>2021 [YR2021]</th>\n",
       "      <th>2022 [YR2022]</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Afghanistan</td>\n",
       "      <td>AFG</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>0.170626997947693</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>...</td>\n",
       "      <td>0.53</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.39</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Albania</td>\n",
       "      <td>ALB</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>5.1026759147644</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>...</td>\n",
       "      <td>2.89</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Algeria</td>\n",
       "      <td>DZA</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>3.18740749359131</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>...</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>1.9</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>American Samoa</td>\n",
       "      <td>ASM</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>...</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Andorra</td>\n",
       "      <td>AND</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>...</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>261</th>\n",
       "      <td>Sub-Saharan Africa</td>\n",
       "      <td>SSF</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>1.40371523425275</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>...</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>262</th>\n",
       "      <td>Sub-Saharan Africa (excluding high income)</td>\n",
       "      <td>SSA</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>1.40254846954039</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>...</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>263</th>\n",
       "      <td>Sub-Saharan Africa (IDA &amp; IBRD countries)</td>\n",
       "      <td>TSS</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>1.40371523425275</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>...</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>264</th>\n",
       "      <td>Upper middle income</td>\n",
       "      <td>UMC</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>...</td>\n",
       "      <td>3.17903199413055</td>\n",
       "      <td>3.27884712306543</td>\n",
       "      <td>3.30094476163683</td>\n",
       "      <td>3.42633181401315</td>\n",
       "      <td>3.58871129608678</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>265</th>\n",
       "      <td>World</td>\n",
       "      <td>WLD</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>...</td>\n",
       "      <td>2.81623769370133</td>\n",
       "      <td>2.76763715889911</td>\n",
       "      <td>2.69356783229575</td>\n",
       "      <td>2.72594201331579</td>\n",
       "      <td>2.88112023910214</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "      <td>..</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>266 rows × 67 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   Country Name Country Code  \\\n",
       "0                                   Afghanistan          AFG   \n",
       "1                                       Albania          ALB   \n",
       "2                                       Algeria          DZA   \n",
       "3                                American Samoa          ASM   \n",
       "4                                       Andorra          AND   \n",
       "..                                          ...          ...   \n",
       "261                          Sub-Saharan Africa          SSF   \n",
       "262  Sub-Saharan Africa (excluding high income)          SSA   \n",
       "263   Sub-Saharan Africa (IDA & IBRD countries)          TSS   \n",
       "264                         Upper middle income          UMC   \n",
       "265                                       World          WLD   \n",
       "\n",
       "                          Series Name     Series Code      1960 [YR1960]  \\\n",
       "0    Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS  0.170626997947693   \n",
       "1    Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS    5.1026759147644   \n",
       "2    Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS   3.18740749359131   \n",
       "3    Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS                 ..   \n",
       "4    Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS                 ..   \n",
       "..                                ...             ...                ...   \n",
       "261  Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS   1.40371523425275   \n",
       "262  Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS   1.40254846954039   \n",
       "263  Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS   1.40371523425275   \n",
       "264  Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS                 ..   \n",
       "265  Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS                 ..   \n",
       "\n",
       "    1961 [YR1961] 1962 [YR1962] 1963 [YR1963] 1964 [YR1964] 1965 [YR1965]  \\\n",
       "0              ..            ..            ..            ..            ..   \n",
       "1              ..            ..            ..            ..            ..   \n",
       "2              ..            ..            ..            ..            ..   \n",
       "3              ..            ..            ..            ..            ..   \n",
       "4              ..            ..            ..            ..            ..   \n",
       "..            ...           ...           ...           ...           ...   \n",
       "261            ..            ..            ..            ..            ..   \n",
       "262            ..            ..            ..            ..            ..   \n",
       "263            ..            ..            ..            ..            ..   \n",
       "264            ..            ..            ..            ..            ..   \n",
       "265            ..            ..            ..            ..            ..   \n",
       "\n",
       "     ...     2013 [YR2013]     2014 [YR2014]     2015 [YR2015]  \\\n",
       "0    ...              0.53               0.5               0.5   \n",
       "1    ...              2.89                ..                ..   \n",
       "2    ...                ..                ..               1.9   \n",
       "3    ...                ..                ..                ..   \n",
       "4    ...                ..                ..                ..   \n",
       "..   ...               ...               ...               ...   \n",
       "261  ...                ..                ..                ..   \n",
       "262  ...                ..                ..                ..   \n",
       "263  ...                ..                ..                ..   \n",
       "264  ...  3.17903199413055  3.27884712306543  3.30094476163683   \n",
       "265  ...  2.81623769370133  2.76763715889911  2.69356783229575   \n",
       "\n",
       "        2016 [YR2016]     2017 [YR2017] 2018 [YR2018] 2019 [YR2019]  \\\n",
       "0                 0.5              0.39            ..            ..   \n",
       "1                  ..                ..            ..            ..   \n",
       "2                  ..                ..            ..            ..   \n",
       "3                  ..                ..            ..            ..   \n",
       "4                  ..                ..            ..            ..   \n",
       "..                ...               ...           ...           ...   \n",
       "261                ..                ..            ..            ..   \n",
       "262                ..                ..            ..            ..   \n",
       "263                ..                ..            ..            ..   \n",
       "264  3.42633181401315  3.58871129608678            ..            ..   \n",
       "265  2.72594201331579  2.88112023910214            ..            ..   \n",
       "\n",
       "    2020 [YR2020] 2021 [YR2021] 2022 [YR2022]  \n",
       "0              ..            ..            ..  \n",
       "1              ..            ..            ..  \n",
       "2              ..            ..            ..  \n",
       "3              ..            ..            ..  \n",
       "4              ..            ..            ..  \n",
       "..            ...           ...           ...  \n",
       "261            ..            ..            ..  \n",
       "262            ..            ..            ..  \n",
       "263            ..            ..            ..  \n",
       "264            ..            ..            ..  \n",
       "265            ..            ..            ..  \n",
       "\n",
       "[266 rows x 67 columns]"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# El presente trabajo analizará el indicador Hospital beds (per 1,000 people) presente en la base de datos \"World Development Indicators\"\n",
    "# Fecha: Actualización 18/12/2023\n",
    "# Paso 1: Se carga la base de datos y se selecciona el indicador a trabajar (COD Serie: SH.MED.BEDS.ZS)\n",
    "import pandas as pd\n",
    "\n",
    "location_hospital = \"H:\\\\05. Jupyter Notebooks\\\\Fundamentos Python\\\\Trabajo Final\\\\51f7ab6a-24ed-4a06-9f5d-04873f1673fd_Data-1.csv\"\n",
    "db_hospital = pd.read_csv(location_hospital, encoding=\"latin-1\")\n",
    "db_filtrada = db_hospital[db_hospital['Series Code'] == 'SH.MED.BEDS.ZS'].reset_index(drop=True)\n",
    "db_filtrada"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "5a9da7bb-f521-4af3-83f6-a7ee0bc3ea59",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 266 entries, 0 to 265\n",
      "Data columns (total 67 columns):\n",
      " #   Column         Non-Null Count  Dtype \n",
      "---  ------         --------------  ----- \n",
      " 0   Country Name   266 non-null    object\n",
      " 1   Country Code   266 non-null    object\n",
      " 2   Series Name    266 non-null    object\n",
      " 3   Series Code    266 non-null    object\n",
      " 4   1960 [YR1960]  266 non-null    object\n",
      " 5   1961 [YR1961]  266 non-null    object\n",
      " 6   1962 [YR1962]  266 non-null    object\n",
      " 7   1963 [YR1963]  266 non-null    object\n",
      " 8   1964 [YR1964]  266 non-null    object\n",
      " 9   1965 [YR1965]  266 non-null    object\n",
      " 10  1966 [YR1966]  266 non-null    object\n",
      " 11  1967 [YR1967]  266 non-null    object\n",
      " 12  1968 [YR1968]  266 non-null    object\n",
      " 13  1969 [YR1969]  266 non-null    object\n",
      " 14  1970 [YR1970]  266 non-null    object\n",
      " 15  1971 [YR1971]  266 non-null    object\n",
      " 16  1972 [YR1972]  266 non-null    object\n",
      " 17  1973 [YR1973]  266 non-null    object\n",
      " 18  1974 [YR1974]  266 non-null    object\n",
      " 19  1975 [YR1975]  266 non-null    object\n",
      " 20  1976 [YR1976]  266 non-null    object\n",
      " 21  1977 [YR1977]  266 non-null    object\n",
      " 22  1978 [YR1978]  266 non-null    object\n",
      " 23  1979 [YR1979]  266 non-null    object\n",
      " 24  1980 [YR1980]  266 non-null    object\n",
      " 25  1981 [YR1981]  266 non-null    object\n",
      " 26  1982 [YR1982]  266 non-null    object\n",
      " 27  1983 [YR1983]  266 non-null    object\n",
      " 28  1984 [YR1984]  266 non-null    object\n",
      " 29  1985 [YR1985]  266 non-null    object\n",
      " 30  1986 [YR1986]  266 non-null    object\n",
      " 31  1987 [YR1987]  266 non-null    object\n",
      " 32  1988 [YR1988]  266 non-null    object\n",
      " 33  1989 [YR1989]  266 non-null    object\n",
      " 34  1990 [YR1990]  266 non-null    object\n",
      " 35  1991 [YR1991]  266 non-null    object\n",
      " 36  1992 [YR1992]  266 non-null    object\n",
      " 37  1993 [YR1993]  266 non-null    object\n",
      " 38  1994 [YR1994]  266 non-null    object\n",
      " 39  1995 [YR1995]  266 non-null    object\n",
      " 40  1996 [YR1996]  266 non-null    object\n",
      " 41  1997 [YR1997]  266 non-null    object\n",
      " 42  1998 [YR1998]  266 non-null    object\n",
      " 43  1999 [YR1999]  266 non-null    object\n",
      " 44  2000 [YR2000]  266 non-null    object\n",
      " 45  2001 [YR2001]  266 non-null    object\n",
      " 46  2002 [YR2002]  266 non-null    object\n",
      " 47  2003 [YR2003]  266 non-null    object\n",
      " 48  2004 [YR2004]  266 non-null    object\n",
      " 49  2005 [YR2005]  266 non-null    object\n",
      " 50  2006 [YR2006]  266 non-null    object\n",
      " 51  2007 [YR2007]  266 non-null    object\n",
      " 52  2008 [YR2008]  266 non-null    object\n",
      " 53  2009 [YR2009]  266 non-null    object\n",
      " 54  2010 [YR2010]  266 non-null    object\n",
      " 55  2011 [YR2011]  266 non-null    object\n",
      " 56  2012 [YR2012]  266 non-null    object\n",
      " 57  2013 [YR2013]  266 non-null    object\n",
      " 58  2014 [YR2014]  266 non-null    object\n",
      " 59  2015 [YR2015]  266 non-null    object\n",
      " 60  2016 [YR2016]  266 non-null    object\n",
      " 61  2017 [YR2017]  266 non-null    object\n",
      " 62  2018 [YR2018]  266 non-null    object\n",
      " 63  2019 [YR2019]  266 non-null    object\n",
      " 64  2020 [YR2020]  266 non-null    object\n",
      " 65  2021 [YR2021]  266 non-null    object\n",
      " 66  2022 [YR2022]  266 non-null    object\n",
      "dtypes: object(67)\n",
      "memory usage: 139.4+ KB\n"
     ]
    }
   ],
   "source": [
    "# Paso 2: Validar la información de la Base de Datos Extraida.\n",
    "db_filtrada.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "914d5255-413f-4c6c-9178-e7944af8b658",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 266 entries, 0 to 265\n",
      "Data columns (total 67 columns):\n",
      " #   Column         Non-Null Count  Dtype \n",
      "---  ------         --------------  ----- \n",
      " 0   Country Name   266 non-null    object\n",
      " 1   Country Code   266 non-null    object\n",
      " 2   Series Name    266 non-null    object\n",
      " 3   Series Code    266 non-null    object\n",
      " 4   1960 [YR1960]  164 non-null    object\n",
      " 5   1961 [YR1961]  2 non-null      object\n",
      " 6   1962 [YR1962]  2 non-null      object\n",
      " 7   1963 [YR1963]  2 non-null      object\n",
      " 8   1964 [YR1964]  2 non-null      object\n",
      " 9   1965 [YR1965]  8 non-null      object\n",
      " 10  1966 [YR1966]  5 non-null      object\n",
      " 11  1967 [YR1967]  5 non-null      object\n",
      " 12  1968 [YR1968]  5 non-null      object\n",
      " 13  1969 [YR1969]  5 non-null      object\n",
      " 14  1970 [YR1970]  176 non-null    object\n",
      " 15  1971 [YR1971]  8 non-null      object\n",
      " 16  1972 [YR1972]  9 non-null      object\n",
      " 17  1973 [YR1973]  9 non-null      object\n",
      " 18  1974 [YR1974]  11 non-null     object\n",
      " 19  1975 [YR1975]  92 non-null     object\n",
      " 20  1976 [YR1976]  15 non-null     object\n",
      " 21  1977 [YR1977]  11 non-null     object\n",
      " 22  1978 [YR1978]  12 non-null     object\n",
      " 23  1979 [YR1979]  12 non-null     object\n",
      " 24  1980 [YR1980]  131 non-null    object\n",
      " 25  1981 [YR1981]  74 non-null     object\n",
      " 26  1982 [YR1982]  30 non-null     object\n",
      " 27  1983 [YR1983]  26 non-null     object\n",
      " 28  1984 [YR1984]  33 non-null     object\n",
      " 29  1985 [YR1985]  100 non-null    object\n",
      " 30  1986 [YR1986]  58 non-null     object\n",
      " 31  1987 [YR1987]  62 non-null     object\n",
      " 32  1988 [YR1988]  61 non-null     object\n",
      " 33  1989 [YR1989]  84 non-null     object\n",
      " 34  1990 [YR1990]  190 non-null    object\n",
      " 35  1991 [YR1991]  96 non-null     object\n",
      " 36  1992 [YR1992]  84 non-null     object\n",
      " 37  1993 [YR1993]  109 non-null    object\n",
      " 38  1994 [YR1994]  84 non-null     object\n",
      " 39  1995 [YR1995]  84 non-null     object\n",
      " 40  1996 [YR1996]  117 non-null    object\n",
      " 41  1997 [YR1997]  82 non-null     object\n",
      " 42  1998 [YR1998]  80 non-null     object\n",
      " 43  1999 [YR1999]  74 non-null     object\n",
      " 44  2000 [YR2000]  130 non-null    object\n",
      " 45  2001 [YR2001]  130 non-null    object\n",
      " 46  2002 [YR2002]  142 non-null    object\n",
      " 47  2003 [YR2003]  139 non-null    object\n",
      " 48  2004 [YR2004]  129 non-null    object\n",
      " 49  2005 [YR2005]  166 non-null    object\n",
      " 50  2006 [YR2006]  168 non-null    object\n",
      " 51  2007 [YR2007]  151 non-null    object\n",
      " 52  2008 [YR2008]  145 non-null    object\n",
      " 53  2009 [YR2009]  159 non-null    object\n",
      " 54  2010 [YR2010]  171 non-null    object\n",
      " 55  2011 [YR2011]  160 non-null    object\n",
      " 56  2012 [YR2012]  146 non-null    object\n",
      " 57  2013 [YR2013]  140 non-null    object\n",
      " 58  2014 [YR2014]  141 non-null    object\n",
      " 59  2015 [YR2015]  137 non-null    object\n",
      " 60  2016 [YR2016]  131 non-null    object\n",
      " 61  2017 [YR2017]  127 non-null    object\n",
      " 62  2018 [YR2018]  41 non-null     object\n",
      " 63  2019 [YR2019]  8 non-null      object\n",
      " 64  2020 [YR2020]  0 non-null      object\n",
      " 65  2021 [YR2021]  0 non-null      object\n",
      " 66  2022 [YR2022]  0 non-null      object\n",
      "dtypes: object(67)\n",
      "memory usage: 139.4+ KB\n"
     ]
    }
   ],
   "source": [
    "# Paso 3: Reemplazar el valor .. por (vacio), transformar los valores de la columna en posicion 4 a mumericos, y hacer el resumen por columna\n",
    "# a fin de decidir que años son los que se van a trabajar (los que tengan mayores datos).\n",
    "\n",
    "db_filtrada.loc[:, '1960 [YR1960]':'2022 [YR2022]'] = db_filtrada.loc[:, '1960 [YR1960]':'2022 [YR2022]'].replace('..', '')\n",
    "db_filtrada.loc[:, '1960 [YR1960]':'2022 [YR2022]'] = db_filtrada.loc[:, '1960 [YR1960]':'2022 [YR2022]'].apply(pd.to_numeric, errors='coerce')\n",
    "db_filtrada.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "ea905e9c-bbdd-43af-a41e-3a01cc51c19c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 266 entries, 0 to 265\n",
      "Data columns (total 15 columns):\n",
      " #   Column         Non-Null Count  Dtype \n",
      "---  ------         --------------  ----- \n",
      " 0   Country Name   266 non-null    object\n",
      " 1   Country Code   266 non-null    object\n",
      " 2   Series Name    266 non-null    object\n",
      " 3   Series Code    266 non-null    object\n",
      " 4   2000 [YR2000]  130 non-null    object\n",
      " 5   2001 [YR2001]  130 non-null    object\n",
      " 6   2002 [YR2002]  142 non-null    object\n",
      " 7   2003 [YR2003]  139 non-null    object\n",
      " 8   2004 [YR2004]  129 non-null    object\n",
      " 9   2005 [YR2005]  166 non-null    object\n",
      " 10  2006 [YR2006]  168 non-null    object\n",
      " 11  2007 [YR2007]  151 non-null    object\n",
      " 12  2008 [YR2008]  145 non-null    object\n",
      " 13  2009 [YR2009]  159 non-null    object\n",
      " 14  2010 [YR2010]  171 non-null    object\n",
      "dtypes: object(15)\n",
      "memory usage: 31.3+ KB\n"
     ]
    }
   ],
   "source": [
    "# Paso 4: Seleecionar los años del 2000 al 2010, ya que se trabajara con esta data.\n",
    "\n",
    "db_seleccionada = db_filtrada[['Country Name', 'Country Code', 'Series Name', 'Series Code', \n",
    "                               '2000 [YR2000]', '2001 [YR2001]', '2002 [YR2002]', \n",
    "                               '2003 [YR2003]', '2004 [YR2004]', '2005 [YR2005]', \n",
    "                               '2006 [YR2006]', '2007 [YR2007]', '2008 [YR2008]', \n",
    "                               '2009 [YR2009]', '2010 [YR2010]']]\n",
    "db_seleccionada.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "f7f655d3-faea-41f0-9933-4971e59ede4a",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Victor M. Cabrera\\AppData\\Local\\Temp\\ipykernel_26100\\494425029.py:4: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  db_seleccionada.loc[:, 'Total_Valores_No_Null'] = db_seleccionada.loc[:, '2000 [YR2000]':'2010 [YR2010]'].count(axis=1)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Country Name</th>\n",
       "      <th>Country Code</th>\n",
       "      <th>Series Name</th>\n",
       "      <th>Series Code</th>\n",
       "      <th>2000 [YR2000]</th>\n",
       "      <th>2001 [YR2001]</th>\n",
       "      <th>2002 [YR2002]</th>\n",
       "      <th>2003 [YR2003]</th>\n",
       "      <th>2004 [YR2004]</th>\n",
       "      <th>2005 [YR2005]</th>\n",
       "      <th>2006 [YR2006]</th>\n",
       "      <th>2007 [YR2007]</th>\n",
       "      <th>2008 [YR2008]</th>\n",
       "      <th>2009 [YR2009]</th>\n",
       "      <th>2010 [YR2010]</th>\n",
       "      <th>Total_Valores_No_Null</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Afghanistan</td>\n",
       "      <td>AFG</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>0.3</td>\n",
       "      <td>0.39</td>\n",
       "      <td>0.39</td>\n",
       "      <td>0.39</td>\n",
       "      <td>0.39</td>\n",
       "      <td>0.42</td>\n",
       "      <td>0.42</td>\n",
       "      <td>0.42</td>\n",
       "      <td>0.42</td>\n",
       "      <td>0.42</td>\n",
       "      <td>0.43</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Armenia</td>\n",
       "      <td>ARM</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>6.44</td>\n",
       "      <td>5.03</td>\n",
       "      <td>4.35</td>\n",
       "      <td>4.42</td>\n",
       "      <td>4.44</td>\n",
       "      <td>4.46</td>\n",
       "      <td>4.42</td>\n",
       "      <td>4.07</td>\n",
       "      <td>3.82</td>\n",
       "      <td>3.72</td>\n",
       "      <td>3.73</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Austria</td>\n",
       "      <td>AUT</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>7.95</td>\n",
       "      <td>7.85</td>\n",
       "      <td>7.81</td>\n",
       "      <td>7.73</td>\n",
       "      <td>7.73</td>\n",
       "      <td>7.69</td>\n",
       "      <td>7.66</td>\n",
       "      <td>7.75</td>\n",
       "      <td>7.69</td>\n",
       "      <td>7.68</td>\n",
       "      <td>7.65</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Azerbaijan</td>\n",
       "      <td>AZE</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>8.69</td>\n",
       "      <td>8.51</td>\n",
       "      <td>8.4</td>\n",
       "      <td>8.27</td>\n",
       "      <td>8.24</td>\n",
       "      <td>8.21</td>\n",
       "      <td>7.94</td>\n",
       "      <td>7.93</td>\n",
       "      <td>7.67</td>\n",
       "      <td>7.54</td>\n",
       "      <td>5.06</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Bahrain</td>\n",
       "      <td>BHR</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>2.75</td>\n",
       "      <td>2.82</td>\n",
       "      <td>2.86</td>\n",
       "      <td>2.81</td>\n",
       "      <td>2.81</td>\n",
       "      <td>2.81</td>\n",
       "      <td>2.74</td>\n",
       "      <td>2.74</td>\n",
       "      <td>1.97</td>\n",
       "      <td>1.9</td>\n",
       "      <td>1.77</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84</th>\n",
       "      <td>Middle East &amp; North Africa (IDA &amp; IBRD countries)</td>\n",
       "      <td>TMN</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>1.640245</td>\n",
       "      <td>1.616759</td>\n",
       "      <td>1.647629</td>\n",
       "      <td>1.643646</td>\n",
       "      <td>1.672061</td>\n",
       "      <td>1.672625</td>\n",
       "      <td>1.711168</td>\n",
       "      <td>1.674968</td>\n",
       "      <td>1.61271</td>\n",
       "      <td>1.516716</td>\n",
       "      <td>1.611779</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>85</th>\n",
       "      <td>North America</td>\n",
       "      <td>NAC</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>3.517464</td>\n",
       "      <td>3.491598</td>\n",
       "      <td>3.414578</td>\n",
       "      <td>3.346719</td>\n",
       "      <td>3.277704</td>\n",
       "      <td>3.190162</td>\n",
       "      <td>3.164253</td>\n",
       "      <td>3.122282</td>\n",
       "      <td>3.102404</td>\n",
       "      <td>3.052338</td>\n",
       "      <td>3.023258</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>86</th>\n",
       "      <td>OECD members</td>\n",
       "      <td>OED</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>5.540191</td>\n",
       "      <td>5.481366</td>\n",
       "      <td>5.438496</td>\n",
       "      <td>5.241962</td>\n",
       "      <td>5.179311</td>\n",
       "      <td>5.245881</td>\n",
       "      <td>5.05044</td>\n",
       "      <td>5.035159</td>\n",
       "      <td>5.116772</td>\n",
       "      <td>5.053859</td>\n",
       "      <td>4.884835</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87</th>\n",
       "      <td>Post-demographic dividend</td>\n",
       "      <td>PST</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>6.515925</td>\n",
       "      <td>6.409176</td>\n",
       "      <td>6.341823</td>\n",
       "      <td>6.213556</td>\n",
       "      <td>6.15971</td>\n",
       "      <td>6.067214</td>\n",
       "      <td>6.019865</td>\n",
       "      <td>6.023787</td>\n",
       "      <td>5.942646</td>\n",
       "      <td>5.917988</td>\n",
       "      <td>5.867899</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>88</th>\n",
       "      <td>Upper middle income</td>\n",
       "      <td>UMC</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>2.753284</td>\n",
       "      <td>2.693935</td>\n",
       "      <td>2.459637</td>\n",
       "      <td>2.631038</td>\n",
       "      <td>2.685115</td>\n",
       "      <td>2.730062</td>\n",
       "      <td>2.730458</td>\n",
       "      <td>2.703249</td>\n",
       "      <td>2.780191</td>\n",
       "      <td>2.62854</td>\n",
       "      <td>2.682158</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>89 rows × 16 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                         Country Name Country Code  \\\n",
       "0                                         Afghanistan          AFG   \n",
       "1                                             Armenia          ARM   \n",
       "2                                             Austria          AUT   \n",
       "3                                          Azerbaijan          AZE   \n",
       "4                                             Bahrain          BHR   \n",
       "..                                                ...          ...   \n",
       "84  Middle East & North Africa (IDA & IBRD countries)          TMN   \n",
       "85                                      North America          NAC   \n",
       "86                                       OECD members          OED   \n",
       "87                          Post-demographic dividend          PST   \n",
       "88                                Upper middle income          UMC   \n",
       "\n",
       "                         Series Name     Series Code 2000 [YR2000]  \\\n",
       "0   Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS           0.3   \n",
       "1   Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS          6.44   \n",
       "2   Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS          7.95   \n",
       "3   Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS          8.69   \n",
       "4   Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS          2.75   \n",
       "..                               ...             ...           ...   \n",
       "84  Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS      1.640245   \n",
       "85  Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS      3.517464   \n",
       "86  Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS      5.540191   \n",
       "87  Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS      6.515925   \n",
       "88  Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS      2.753284   \n",
       "\n",
       "   2001 [YR2001] 2002 [YR2002] 2003 [YR2003] 2004 [YR2004] 2005 [YR2005]  \\\n",
       "0           0.39          0.39          0.39          0.39          0.42   \n",
       "1           5.03          4.35          4.42          4.44          4.46   \n",
       "2           7.85          7.81          7.73          7.73          7.69   \n",
       "3           8.51           8.4          8.27          8.24          8.21   \n",
       "4           2.82          2.86          2.81          2.81          2.81   \n",
       "..           ...           ...           ...           ...           ...   \n",
       "84      1.616759      1.647629      1.643646      1.672061      1.672625   \n",
       "85      3.491598      3.414578      3.346719      3.277704      3.190162   \n",
       "86      5.481366      5.438496      5.241962      5.179311      5.245881   \n",
       "87      6.409176      6.341823      6.213556       6.15971      6.067214   \n",
       "88      2.693935      2.459637      2.631038      2.685115      2.730062   \n",
       "\n",
       "   2006 [YR2006] 2007 [YR2007] 2008 [YR2008] 2009 [YR2009] 2010 [YR2010]  \\\n",
       "0           0.42          0.42          0.42          0.42          0.43   \n",
       "1           4.42          4.07          3.82          3.72          3.73   \n",
       "2           7.66          7.75          7.69          7.68          7.65   \n",
       "3           7.94          7.93          7.67          7.54          5.06   \n",
       "4           2.74          2.74          1.97           1.9          1.77   \n",
       "..           ...           ...           ...           ...           ...   \n",
       "84      1.711168      1.674968       1.61271      1.516716      1.611779   \n",
       "85      3.164253      3.122282      3.102404      3.052338      3.023258   \n",
       "86       5.05044      5.035159      5.116772      5.053859      4.884835   \n",
       "87      6.019865      6.023787      5.942646      5.917988      5.867899   \n",
       "88      2.730458      2.703249      2.780191       2.62854      2.682158   \n",
       "\n",
       "    Total_Valores_No_Null  \n",
       "0                      11  \n",
       "1                      11  \n",
       "2                      11  \n",
       "3                      11  \n",
       "4                      11  \n",
       "..                    ...  \n",
       "84                     11  \n",
       "85                     11  \n",
       "86                     11  \n",
       "87                     11  \n",
       "88                     11  \n",
       "\n",
       "[89 rows x 16 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Paso 5: Crear una nueva columna que cuente los valores No Null en los años del 2000 al 2010.\n",
    "# Y filtrar las filas que tengan solo 11 observaciones\n",
    "\n",
    "db_seleccionada.loc[:, 'Total_Valores_No_Null'] = db_seleccionada.loc[:, '2000 [YR2000]':'2010 [YR2010]'].count(axis=1)\n",
    "con_filtrado = db_seleccionada['Total_Valores_No_Null'] == 11\n",
    "db_completa = db_seleccionada[con_filtrado].reset_index(drop=True)\n",
    "db_completa"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "7e6f1146-2a8a-4bf0-9fac-04b1eb051f7a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Paso 6: Comprobar Base de Datos"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "2f9a9d81-c527-4f34-951b-41dd8b1b0d6b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 89 entries, 0 to 88\n",
      "Data columns (total 16 columns):\n",
      " #   Column                 Non-Null Count  Dtype \n",
      "---  ------                 --------------  ----- \n",
      " 0   Country Name           89 non-null     object\n",
      " 1   Country Code           89 non-null     object\n",
      " 2   Series Name            89 non-null     object\n",
      " 3   Series Code            89 non-null     object\n",
      " 4   2000 [YR2000]          89 non-null     object\n",
      " 5   2001 [YR2001]          89 non-null     object\n",
      " 6   2002 [YR2002]          89 non-null     object\n",
      " 7   2003 [YR2003]          89 non-null     object\n",
      " 8   2004 [YR2004]          89 non-null     object\n",
      " 9   2005 [YR2005]          89 non-null     object\n",
      " 10  2006 [YR2006]          89 non-null     object\n",
      " 11  2007 [YR2007]          89 non-null     object\n",
      " 12  2008 [YR2008]          89 non-null     object\n",
      " 13  2009 [YR2009]          89 non-null     object\n",
      " 14  2010 [YR2010]          89 non-null     object\n",
      " 15  Total_Valores_No_Null  89 non-null     int64 \n",
      "dtypes: int64(1), object(15)\n",
      "memory usage: 11.2+ KB\n"
     ]
    }
   ],
   "source": [
    "db_completa.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "bcfc4ad8-5a0d-4521-9569-5a82f44386ae",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['Afghanistan' 'Armenia' 'Austria' 'Azerbaijan' 'Bahrain' 'Belarus'\n",
      " 'Belgium' 'Bosnia and Herzegovina' 'Bulgaria' 'Canada' 'Chile' 'China'\n",
      " 'Costa Rica' 'Croatia' 'Cyprus' 'Czechia' 'Denmark' 'Egypt, Arab Rep.'\n",
      " 'Estonia' 'Finland' 'France' 'Georgia' 'Germany' 'Greece' 'Hungary'\n",
      " 'Iran, Islamic Rep.' 'Iraq' 'Ireland' 'Israel' 'Italy' 'Japan' 'Jordan'\n",
      " 'Kazakhstan' 'Korea, Rep.' 'Kuwait' 'Kyrgyz Republic' 'Latvia' 'Lebanon'\n",
      " 'Libya' 'Lithuania' 'Luxembourg' 'Malta' 'Mexico' 'Moldova' 'Montenegro'\n",
      " 'Morocco' 'Netherlands' 'North Macedonia' 'Norway' 'Oman' 'Portugal'\n",
      " 'Qatar' 'Romania' 'Russian Federation' 'Slovak Republic' 'Slovenia'\n",
      " 'Spain' 'Sudan' 'Sweden' 'Switzerland' 'Syrian Arab Republic'\n",
      " 'Tajikistan' 'Tunisia' 'Turkiye' 'Turkmenistan' 'Ukraine'\n",
      " 'United Arab Emirates' 'United Kingdom' 'United States' 'Uzbekistan'\n",
      " 'Yemen, Rep.' 'Arab World' 'East Asia & Pacific'\n",
      " 'East Asia & Pacific (excluding high income)'\n",
      " 'East Asia & Pacific (IDA & IBRD countries)' 'Euro area'\n",
      " 'Europe & Central Asia' 'Europe & Central Asia (excluding high income)'\n",
      " 'Europe & Central Asia (IDA & IBRD countries)' 'European Union'\n",
      " 'High income' 'Late-demographic dividend' 'Middle East & North Africa'\n",
      " 'Middle East & North Africa (excluding high income)'\n",
      " 'Middle East & North Africa (IDA & IBRD countries)' 'North America'\n",
      " 'OECD members' 'Post-demographic dividend' 'Upper middle income']\n"
     ]
    }
   ],
   "source": [
    "# Paso 7: Obtener la lista de paises para:\n",
    "# a) Ver la evolucion del indicador en un solo pais\n",
    "# b) Comparar el pais elegido con otro de su región\n",
    "# El pais elegido es \"Portugal\"\n",
    "\n",
    "nom_paises = db_completa['Country Name'].unique()\n",
    "print(nom_paises)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "f0fc5661-4876-4e32-a751-76bd2d7f41d6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Country Name</th>\n",
       "      <th>Country Code</th>\n",
       "      <th>Series Name</th>\n",
       "      <th>Series Code</th>\n",
       "      <th>2000 [YR2000]</th>\n",
       "      <th>2001 [YR2001]</th>\n",
       "      <th>2002 [YR2002]</th>\n",
       "      <th>2003 [YR2003]</th>\n",
       "      <th>2004 [YR2004]</th>\n",
       "      <th>2005 [YR2005]</th>\n",
       "      <th>2006 [YR2006]</th>\n",
       "      <th>2007 [YR2007]</th>\n",
       "      <th>2008 [YR2008]</th>\n",
       "      <th>2009 [YR2009]</th>\n",
       "      <th>2010 [YR2010]</th>\n",
       "      <th>Total_Valores_No_Null</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Portugal</td>\n",
       "      <td>PRT</td>\n",
       "      <td>Hospital beds (per 1,000 people)</td>\n",
       "      <td>SH.MED.BEDS.ZS</td>\n",
       "      <td>3.71</td>\n",
       "      <td>3.65</td>\n",
       "      <td>3.57</td>\n",
       "      <td>3.58</td>\n",
       "      <td>3.59</td>\n",
       "      <td>3.56</td>\n",
       "      <td>3.48</td>\n",
       "      <td>3.44</td>\n",
       "      <td>3.39</td>\n",
       "      <td>3.37</td>\n",
       "      <td>3.37</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Country Name Country Code                       Series Name     Series Code  \\\n",
       "0     Portugal          PRT  Hospital beds (per 1,000 people)  SH.MED.BEDS.ZS   \n",
       "\n",
       "  2000 [YR2000] 2001 [YR2001] 2002 [YR2002] 2003 [YR2003] 2004 [YR2004]  \\\n",
       "0          3.71          3.65          3.57          3.58          3.59   \n",
       "\n",
       "  2005 [YR2005] 2006 [YR2006] 2007 [YR2007] 2008 [YR2008] 2009 [YR2009]  \\\n",
       "0          3.56          3.48          3.44          3.39          3.37   \n",
       "\n",
       "  2010 [YR2010]  Total_Valores_No_Null  \n",
       "0          3.37                     11  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pais_elegido = \"Portugal\"\n",
    "db_portugal = db_completa[db_completa['Country Name'] == pais_elegido].reset_index(drop=True)\n",
    "db_portugal"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "25ef18fc-7163-4a61-9171-ec5875f71cef",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "<style>\n",
       "  #altair-viz-1f36df7ca03643b69631f2641040703d.vega-embed {\n",
       "    width: 100%;\n",
       "    display: flex;\n",
       "  }\n",
       "\n",
       "  #altair-viz-1f36df7ca03643b69631f2641040703d.vega-embed details,\n",
       "  #altair-viz-1f36df7ca03643b69631f2641040703d.vega-embed details summary {\n",
       "    position: relative;\n",
       "  }\n",
       "</style>\n",
       "<div id=\"altair-viz-1f36df7ca03643b69631f2641040703d\"></div>\n",
       "<script type=\"text/javascript\">\n",
       "  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n",
       "  (function(spec, embedOpt){\n",
       "    let outputDiv = document.currentScript.previousElementSibling;\n",
       "    if (outputDiv.id !== \"altair-viz-1f36df7ca03643b69631f2641040703d\") {\n",
       "      outputDiv = document.getElementById(\"altair-viz-1f36df7ca03643b69631f2641040703d\");\n",
       "    }\n",
       "    const paths = {\n",
       "      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@5?noext\",\n",
       "      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n",
       "      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@5.16.3?noext\",\n",
       "      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@6?noext\",\n",
       "    };\n",
       "\n",
       "    function maybeLoadScript(lib, version) {\n",
       "      var key = `${lib.replace(\"-\", \"\")}_version`;\n",
       "      return (VEGA_DEBUG[key] == version) ?\n",
       "        Promise.resolve(paths[lib]) :\n",
       "        new Promise(function(resolve, reject) {\n",
       "          var s = document.createElement('script');\n",
       "          document.getElementsByTagName(\"head\")[0].appendChild(s);\n",
       "          s.async = true;\n",
       "          s.onload = () => {\n",
       "            VEGA_DEBUG[key] = version;\n",
       "            return resolve(paths[lib]);\n",
       "          };\n",
       "          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n",
       "          s.src = paths[lib];\n",
       "        });\n",
       "    }\n",
       "\n",
       "    function showError(err) {\n",
       "      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n",
       "      throw err;\n",
       "    }\n",
       "\n",
       "    function displayChart(vegaEmbed) {\n",
       "      vegaEmbed(outputDiv, spec, embedOpt)\n",
       "        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n",
       "    }\n",
       "\n",
       "    if(typeof define === \"function\" && define.amd) {\n",
       "      requirejs.config({paths});\n",
       "      require([\"vega-embed\"], displayChart, err => showError(`Error loading script: ${err.message}`));\n",
       "    } else {\n",
       "      maybeLoadScript(\"vega\", \"5\")\n",
       "        .then(() => maybeLoadScript(\"vega-lite\", \"5.16.3\"))\n",
       "        .then(() => maybeLoadScript(\"vega-embed\", \"6\"))\n",
       "        .catch(showError)\n",
       "        .then(() => displayChart(vegaEmbed));\n",
       "    }\n",
       "  })({\"config\": {\"view\": {\"continuousWidth\": 300, \"continuousHeight\": 300}}, \"data\": {\"name\": \"data-3f6c89e310eb36164deff5cdcad29bb9\"}, \"mark\": {\"type\": \"bar\"}, \"encoding\": {\"color\": {\"value\": \"steelblue\"}, \"tooltip\": [{\"field\": \"Year\", \"type\": \"ordinal\"}, {\"field\": \"Hospital Beds Rate\", \"type\": \"quantitative\"}], \"x\": {\"field\": \"Year\", \"type\": \"ordinal\"}, \"y\": {\"field\": \"Hospital Beds Rate\", \"type\": \"quantitative\"}}, \"height\": 400, \"title\": \"Evoluci\\u00f3n del N\\u00aa de Camas de Hospital en Portugal entre el 2000 y 2010 (camas por 1000 persona)\", \"width\": 600, \"$schema\": \"https://vega.github.io/schema/vega-lite/v5.16.3.json\", \"datasets\": {\"data-3f6c89e310eb36164deff5cdcad29bb9\": [{\"Year\": 2000, \"Hospital Beds Rate\": 3.71}, {\"Year\": 2001, \"Hospital Beds Rate\": 3.65}, {\"Year\": 2002, \"Hospital Beds Rate\": 3.57}, {\"Year\": 2003, \"Hospital Beds Rate\": 3.58}, {\"Year\": 2004, \"Hospital Beds Rate\": 3.59}, {\"Year\": 2005, \"Hospital Beds Rate\": 3.56}, {\"Year\": 2006, \"Hospital Beds Rate\": 3.48}, {\"Year\": 2007, \"Hospital Beds Rate\": 3.44}, {\"Year\": 2008, \"Hospital Beds Rate\": 3.39}, {\"Year\": 2009, \"Hospital Beds Rate\": 3.37}, {\"Year\": 2010, \"Hospital Beds Rate\": 3.37}]}}, {\"mode\": \"vega-lite\"});\n",
       "</script>"
      ],
      "text/plain": [
       "alt.Chart(...)"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Gráfico 1: Evoluación del Nª de Camas de Hospital en Portugal entre el 2000 y 2010 (camas por 1000 persona)\n",
    "\n",
    "# Paso 1: Pasar de wide a long, y seleccionar las columnas a graficar.\n",
    "\n",
    "matriz_long = pd.melt(db_portugal, id_vars=['Country Name', 'Country Code', 'Series Name', 'Series Code', 'Total_Valores_No_Null'], \n",
    "                  var_name='Year', value_name='Hospital Beds Rate')\n",
    "matriz_long['Year'] = matriz_long['Year'].str.extract(r'\\[YR(\\d{4})\\]').astype(int)\n",
    "matriz_selec = matriz_long[['Year', 'Hospital Beds Rate']]\n",
    "matriz_selec\n",
    "\n",
    "# Paso 2: Graficar\n",
    "import altair as alt\n",
    "# Create an Altair chart\n",
    "chart = alt.Chart(matriz_selec).mark_bar().encode(\n",
    "    x='Year:O',\n",
    "    y='Hospital Beds Rate:Q',\n",
    "    color=alt.value('steelblue'),\n",
    "    tooltip=['Year:O', 'Hospital Beds Rate:Q']  \n",
    ").properties(\n",
    "    title='Evolución del Nª de Camas de Hospital en Portugal entre el 2000 y 2010 (camas por 1000 persona)',\n",
    "    width=600,\n",
    "    height=400\n",
    ")\n",
    "\n",
    "# Show the chart\n",
    "chart\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "58aa42f8-5747-48d9-99dc-db7413ac4264",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "<style>\n",
       "  #altair-viz-825d969148c142028e98d1f3c9882e5a.vega-embed {\n",
       "    width: 100%;\n",
       "    display: flex;\n",
       "  }\n",
       "\n",
       "  #altair-viz-825d969148c142028e98d1f3c9882e5a.vega-embed details,\n",
       "  #altair-viz-825d969148c142028e98d1f3c9882e5a.vega-embed details summary {\n",
       "    position: relative;\n",
       "  }\n",
       "</style>\n",
       "<div id=\"altair-viz-825d969148c142028e98d1f3c9882e5a\"></div>\n",
       "<script type=\"text/javascript\">\n",
       "  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n",
       "  (function(spec, embedOpt){\n",
       "    let outputDiv = document.currentScript.previousElementSibling;\n",
       "    if (outputDiv.id !== \"altair-viz-825d969148c142028e98d1f3c9882e5a\") {\n",
       "      outputDiv = document.getElementById(\"altair-viz-825d969148c142028e98d1f3c9882e5a\");\n",
       "    }\n",
       "    const paths = {\n",
       "      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@5?noext\",\n",
       "      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n",
       "      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@5.16.3?noext\",\n",
       "      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@6?noext\",\n",
       "    };\n",
       "\n",
       "    function maybeLoadScript(lib, version) {\n",
       "      var key = `${lib.replace(\"-\", \"\")}_version`;\n",
       "      return (VEGA_DEBUG[key] == version) ?\n",
       "        Promise.resolve(paths[lib]) :\n",
       "        new Promise(function(resolve, reject) {\n",
       "          var s = document.createElement('script');\n",
       "          document.getElementsByTagName(\"head\")[0].appendChild(s);\n",
       "          s.async = true;\n",
       "          s.onload = () => {\n",
       "            VEGA_DEBUG[key] = version;\n",
       "            return resolve(paths[lib]);\n",
       "          };\n",
       "          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n",
       "          s.src = paths[lib];\n",
       "        });\n",
       "    }\n",
       "\n",
       "    function showError(err) {\n",
       "      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n",
       "      throw err;\n",
       "    }\n",
       "\n",
       "    function displayChart(vegaEmbed) {\n",
       "      vegaEmbed(outputDiv, spec, embedOpt)\n",
       "        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n",
       "    }\n",
       "\n",
       "    if(typeof define === \"function\" && define.amd) {\n",
       "      requirejs.config({paths});\n",
       "      require([\"vega-embed\"], displayChart, err => showError(`Error loading script: ${err.message}`));\n",
       "    } else {\n",
       "      maybeLoadScript(\"vega\", \"5\")\n",
       "        .then(() => maybeLoadScript(\"vega-lite\", \"5.16.3\"))\n",
       "        .then(() => maybeLoadScript(\"vega-embed\", \"6\"))\n",
       "        .catch(showError)\n",
       "        .then(() => displayChart(vegaEmbed));\n",
       "    }\n",
       "  })({\"config\": {\"view\": {\"continuousWidth\": 300, \"continuousHeight\": 300}}, \"data\": {\"name\": \"data-18a52415619c36c6c7e65aaeda21acf9\"}, \"mark\": {\"type\": \"point\"}, \"encoding\": {\"x\": {\"field\": \"Hospital Beds Rate\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"Country Name\", \"type\": \"nominal\"}}, \"height\": 400, \"title\": \"Comparaci\\u00f3n paises Europeos sobre el N\\u00aa de Camas de Hospital en 2005 (camas por 1000 persona)\", \"width\": 600, \"$schema\": \"https://vega.github.io/schema/vega-lite/v5.16.3.json\", \"datasets\": {\"data-18a52415619c36c6c7e65aaeda21acf9\": [{\"Country Name\": \"Belgium\", \"Year\": 2005, \"Hospital Beds Rate\": 6.44}, {\"Country Name\": \"Bulgaria\", \"Year\": 2005, \"Hospital Beds Rate\": 6.41}, {\"Country Name\": \"Croatia\", \"Year\": 2005, \"Hospital Beds Rate\": 5.45}, {\"Country Name\": \"Denmark\", \"Year\": 2005, \"Hospital Beds Rate\": 3.86}, {\"Country Name\": \"Finland\", \"Year\": 2005, \"Hospital Beds Rate\": 7.05}, {\"Country Name\": \"France\", \"Year\": 2005, \"Hospital Beds Rate\": 7.22}, {\"Country Name\": \"Germany\", \"Year\": 2005, \"Hospital Beds Rate\": 8.47}, {\"Country Name\": \"Greece\", \"Year\": 2005, \"Hospital Beds Rate\": 4.78}, {\"Country Name\": \"Hungary\", \"Year\": 2005, \"Hospital Beds Rate\": 7.91}, {\"Country Name\": \"Ireland\", \"Year\": 2005, \"Hospital Beds Rate\": 5.46}, {\"Country Name\": \"Italy\", \"Year\": 2005, \"Hospital Beds Rate\": 4.04}, {\"Country Name\": \"Portugal\", \"Year\": 2005, \"Hospital Beds Rate\": 3.56}]}}, {\"mode\": \"vega-lite\"});\n",
       "</script>"
      ],
      "text/plain": [
       "alt.Chart(...)"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Gráfico 2: Comparación paises Europeos sobre el Nª de Camas de Hospital en 2005 (camas por 1000 persona)\n",
    "\n",
    "\n",
    "# Paso 2: Seleccionar datos\n",
    "paises_elegidos = [\"Portugal\", \"Belgium\", \"Bulgaria\", \"Croatia\", \"Denmark\", \"Finland\", \"France\", \"Germany\", \"Greece\", \"Hungary\", \"Ireland\", \"Italy\"]\n",
    "db_pelegidos = db_completa[db_completa['Country Name'].isin(paises_elegidos)].reset_index(drop=True)\n",
    "db_pelegidos\n",
    "\n",
    "# Paso 2: Pasar de wide a long, y seleccionar las columnas a graficar.\n",
    "matriz_longs = pd.melt(db_pelegidos, id_vars=['Country Name', 'Country Code', 'Series Name', 'Series Code', 'Total_Valores_No_Null'], \n",
    "                  var_name='Year', value_name='Hospital Beds Rate')\n",
    "matriz_longs['Year'] = matriz_longs['Year'].str.extract(r'\\[YR(\\d{4})\\]').astype(int)\n",
    "matriz_selecs = matriz_longs[['Country Name', 'Year', 'Hospital Beds Rate']]\n",
    "matriz_selecs_2005 = matriz_selecs[matriz_selecs['Year'] == 2005 ].reset_index(drop=True)\n",
    "matriz_selecs_2005\n",
    "\n",
    "# Paso3: Graficar\n",
    "alt.Chart(matriz_selecs_2005).mark_point().encode(\n",
    "y = \"Country Name\", \n",
    "    x = \"Hospital Beds Rate\"\n",
    "    ).properties(\n",
    "    title='Comparación paises Europeos sobre el Nª de Camas de Hospital en 2005 (camas por 1000 persona)',\n",
    "    width=600,\n",
    "    height=400\n",
    ")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.18"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
